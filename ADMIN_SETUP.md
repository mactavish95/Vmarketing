# Admin Panel Setup Guide

This guide will help you set up and use the admin panel for managing posts and users in your application.

## Features

The admin panel provides the following capabilities:

- **Post Management**: View, hide/show, and delete all posts generated by users
- **User Management**: View user statistics and manage user accounts
- **Analytics**: View comprehensive statistics about posts and engagement
- **Search & Filtering**: Advanced filtering by platform, status, user, and content
- **Bulk Operations**: Manage multiple posts efficiently

## Setup Instructions

### 1. Database Schema Update

The admin functionality requires updates to the existing database schema. The following changes have been made:

- **User Model**: Added `role`, `isActive`, and `lastLoginAt` fields
- **PublishedPost Model**: Added `hidden` field for post visibility control

### 2. Create Admin User

#### Option A: Using Environment Variables (Recommended)

1. Add the following variables to your `.env` file:

```bash
ADMIN_EMAIL=your-admin-email@example.com
ADMIN_PASSWORD=your-secure-password
ADMIN_NAME=Your Admin Name
```

2. Run the admin creation script:

```bash
cd server
node create-admin.js
```

#### Option B: Manual Creation

If you prefer to create the admin user manually, you can use MongoDB directly:

```javascript
// Connect to your MongoDB database
// Create admin user with role: 'admin'
```

### 3. Access the Admin Panel

1. Start your application
2. Navigate to: `http://localhost:3000/admin/login`
3. Login with your admin credentials

## Admin Panel Usage

### Posts Management

The Posts Management tab allows you to:

- **View All Posts**: See all posts generated by users across all platforms
- **Search Posts**: Search by content, user, or other criteria
- **Filter Posts**: Filter by platform (Facebook, Instagram, Twitter, LinkedIn) or status
- **Hide/Show Posts**: Toggle post visibility without deleting them
- **Delete Posts**: Permanently remove posts from the system
- **Sort Posts**: Sort by date, content, or platform

### Statistics Dashboard

The Statistics tab provides:

- **Overview Metrics**: Total posts, users, likes, and comments
- **Platform Breakdown**: Posts distribution across social media platforms
- **Status Distribution**: Posts by status (published, draft, failed, etc.)
- **Time-based Analytics**: Performance metrics over different time periods

### User Management

Admin users can:

- **View User List**: See all registered users with their post counts
- **Create New Users**: Add new user or admin accounts
- **Manage User Status**: Activate or deactivate user accounts
- **View User Statistics**: See how many posts each user has created

## Security Features

### Authentication & Authorization

- **Admin-only Access**: Only users with `role: 'admin'` can access the panel
- **Session Management**: Secure session handling with proper logout functionality
- **Account Protection**: Admins cannot deactivate their own accounts

### Data Protection

- **Input Validation**: All inputs are validated and sanitized
- **CSRF Protection**: Built-in protection against cross-site request forgery
- **Secure Headers**: Proper security headers are set

## API Endpoints

The admin functionality adds the following API endpoints:

### Authentication
- `POST /api/admin/login` - Admin login
- `GET /api/admin/session` - Check admin session
- `POST /api/auth/logout` - Logout (shared with regular users)

### Posts Management
- `GET /api/admin/posts` - Get all posts with filtering
- `PATCH /api/admin/posts/:postId/visibility` - Hide/show posts
- `DELETE /api/admin/posts/:postId` - Delete posts

### Statistics
- `GET /api/admin/stats` - Get comprehensive statistics

### User Management
- `GET /api/admin/users` - Get user list
- `POST /api/admin/users` - Create new users
- `PATCH /api/admin/users/:userId/status` - Update user status

## Environment Variables

Add these to your `.env` file for admin functionality:

```bash
# Admin Configuration
ADMIN_EMAIL=admin@yourdomain.com
ADMIN_PASSWORD=secure-password-here
ADMIN_NAME=Admin User

# Required for all functionality
MONGODB_URI=your-mongodb-connection-string
SESSION_SECRET=your-session-secret
```

## Troubleshooting

### Common Issues

1. **"Admin access required" error**
   - Ensure the user has `role: 'admin'` in the database
   - Check that the user account is active (`isActive: true`)

2. **Posts not showing up**
   - Verify that posts exist in the `PublishedPost` collection
   - Check that the `hidden` field is not set to `true`

3. **Login issues**
   - Ensure MongoDB is running and accessible
   - Check that session configuration is correct
   - Verify environment variables are set properly

### Database Migration

If you have existing data, the new fields will be automatically added with default values:

- `role`: defaults to `'user'`
- `isActive`: defaults to `true`
- `hidden`: defaults to `false`

## Best Practices

1. **Password Security**: Use strong, unique passwords for admin accounts
2. **Regular Backups**: Backup your database regularly
3. **Access Control**: Limit admin access to trusted personnel only
4. **Monitoring**: Monitor admin actions for security purposes
5. **Updates**: Keep the application and dependencies updated

## Support

If you encounter any issues with the admin panel:

1. Check the server logs for error messages
2. Verify all environment variables are set correctly
3. Ensure MongoDB is running and accessible
4. Check that all required dependencies are installed

For additional support, please refer to the main application documentation or contact the development team. 